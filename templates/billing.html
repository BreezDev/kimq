{% extends 'base.html' %}
{% block content %}
<section class="section">
    <h2 class="section-title">Billing & Charges</h2>
    <p class="muted">Review your deposits, gift card purchases, and appointment history.</p>
    <div class="grid">
        <div class="card">
            <h3>Payments</h3>
            <table class="table">
                <tr><th>When</th><th>Amount</th><th>Status</th><th>Type</th></tr>
                {% for p in payments %}
                <tr>
                    <td>{{ p['created_at']|beauty_time }}</td>
                    <td>{{ format_currency(p['amount_cents']) }}</td>
                    <td>{{ p['status'] }}</td>
                    <td>{{ p['category']|replace('_', ' ')|title() }}</td>
                </tr>
                {% else %}
                <tr><td colspan="4" class="muted">No charges yet.</td></tr>
                {% endfor %}
            </table>
        </div>
        <div class="card">
            <h3>Appointments</h3>
            <table class="table">
                <tr><th>Service</th><th>Date</th><th>Status</th><th>Deposit</th></tr>
                {% for appt in appointments %}
                <tr>
                    <td>{{ appt['service_name'] }}</td>
                    <td>{{ appt['start_time']|beauty_time }}</td>
                    <td>{{ appt['status'] }}</td>
                    <td>{{ format_currency(appt['amount_cents'] or 0) }}</td>
                </tr>
                {% else %}
                <tr><td colspan="4" class="muted">No appointments recorded.</td></tr>
                {% endfor %}
            </table>
            <div class="muted small">Need receipts? Reply to any studio email and we'll resend a detailed invoice.</div>
        </div>
    </div>
</section>
{% endblock %}
